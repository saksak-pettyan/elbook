<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kaneko.elbook.mapper.AdminAccountMapper">

    <!--
        T_ADMIN_ACCOUNT の 1 行を AdminAccount クラスにマッピングする定義
    -->
    <resultMap id="AdminAccountResultMap" type="AdminAccount">
        <id     property="adminId"      column="ADMIN_ID"/>
        <result property="passwordHash" column="PASSWORD_HASH"/>
        <result property="initialized"  column="IS_INITIALIZED"/>
    </resultMap>

    <!-- 主キー（ADMIN_ID）で 1 行取得 -->
    <select id="selectById" resultMap="AdminAccountResultMap">
        SELECT
            ADMIN_ID,
            PASSWORD_HASH,
            IS_INITIALIZED
        FROM
            T_ADMIN_ACCOUNT
        WHERE
            ADMIN_ID = #{adminId}
    </select>

    <!-- パスワード更新 + 初期設定フラグ ON -->
    <update id="updatePasswordAndInitialize">
        UPDATE
            T_ADMIN_ACCOUNT
        SET
            PASSWORD_HASH  = #{passwordHash},
            IS_INITIALIZED = 1
        WHERE
            ADMIN_ID = #{adminId}
    </update>

</mapper>
